<!DOCTYPE html>
<html lang="en">

<head>
    <title>Grupparbete</title>
</head>

<body>

    <label for="selectCoffee">Väj kaffesort:</label>

    <select name="selectCoffee" id="selectCoffee">
        <option value="">--Välj kaffesort--</option>
        <option value="Bryggkaffe">Bryggkaffe - 20kr</option>
        <option value="Cappuccino">Cappuccino - 30kr</option>
        <option value="Latte">Latte - 40kr</option>
    </select>

    <label for="numberOfCoffees">Antal</label>
    <input id="numberOfCoffees" />
    <button type="button" onclick="customer1.addTransctionandUpdateHtml()">Köp</button>

    <div>
        Du har handlat för: <p id="totalSpent"> </p>
    </div>
    <div>
        Medlemskapsstatus: <p id="membership"> </p>
    </div>
<hr>

    <h1>Dina transaktioner</h1>
    <p id="transactions"> </p>


    <script>
        const coffees = {
            Bryggkaffe: 20,
            Cappuccino: 30,
            Latte: 40
        }

        class Customer {
            constructor() {
                this.transactions = []
                this.membership = ""
                this.numberOfCups = 0
                this.transactionSum = 0

            }

            getTotalSpent() {
                let sum = 0
                for (let i = 0; i < this.transactions.length; i++) {
                    const element = this.transactions[i]
                    sum += (element.price * element.numberOfCups)
                }
                this.transactionSum = sum
                return this.transactionSum

            }

            addTransaction() {
                let oneTransaction = 0
                let sumOfTransaction = 0
                const typeOfCoffee = document.getElementById("selectCoffee").value
                const numberOfCups = document.getElementById("numberOfCoffees").value
                let transactionMessage = null
                sumOfTransaction = numberOfCups * coffees[typeOfCoffee]
                transactionMessage = (`Du har köpt ${numberOfCups} st ${typeOfCoffee} för ${coffees[typeOfCoffee]} kr/st Summa:${sumOfTransaction}`)
                oneTransaction = { type: typeOfCoffee, numberOfCups: numberOfCups, price: coffees[typeOfCoffee], transactionMessage: transactionMessage }
                this.transactions.push(oneTransaction)
            }

            addTransctionandUpdateHtml() {
                this.addTransaction()
                const totalSpentText = document.getElementById("totalSpent")
                totalSpentText.innerHTML = this.getTotalSpent()

                const membershipText = document.getElementById("membership")
                membershipText.innerHTML = this.getMembershipStatus()

                const transactionText = document.getElementById("transactions")
                transactionText.innerHTML = this.getTotalMessages()
            }


            getMembershipStatus() {
                this.updateTotalCups()
                if (this.numberOfCups < 10) {
                    this.membership = "Brons"
                }
                else if (this.numberOfCups >= 10 && this.numberOfCups < 30) {
                    this.membership = "Silver"
                }
                else if (this.numberOfCups >= 30) {
                    this.membership = "Guld"
                }
                return this.membership
            }

            updateTotalCups() {
                let sum = 0
                for (let i = 0; i < this.transactions.length; i++) {
                    const element = this.transactions[i]
                    sum += element.numberOfCups
                }
                this.numberOfCups = sum

            }

            getTotalMessages() {
                let messages = ""
                for (let i = 0; i < this.transactions.length; i++) {
                    const message = this.transactions[i]
                    messages += message.transactionMessage + "<br>"
                }
                this.messages = messages
                return messages
            }

        }

        let customer1 = new Customer()


    </script>
</body>

</html>